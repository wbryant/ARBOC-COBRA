<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome to ABC-SMC for GEM Improvement’s documentation! &#8212; ABC-SMC for GEM Improvement  documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="welcome-to-abc-smc-for-gem-improvement-s-documentation">
<h1>Welcome to ABC-SMC for GEM Improvement&#8217;s documentation!<a class="headerlink" href="#welcome-to-abc-smc-for-gem-improvement-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<span class="target" id="module-abcsmc"></span><p>ABC-SMC for COBRA models v0.2
Copyright 2017 William A. Bryant</p>
<div class="section" id="abstract">
<h2>ABSTRACT<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This module undertakes Approximate Bayesian Computation using a Sequential
Monte Carlo approach (ABC-SMC) to assess proposed additions and uncertain
enzyme/reaction relationships in a COBRA constraint-based metabolic model, and
find a combination of additions and removals of reactions and enzyme/reaction
relationships to and from an original model that produces a model with
maximum parsimony with a particular set of experimental observations.</p>
</div>
<div class="section" id="summary">
<h2>SUMMARY<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>A specific reaction can be catalysed by one or more (or no) enzymes, which are
either known or unknown.  The assertion that a particular reaction is catalysed
by a particular enzyme, a Reaction/Enzyme Link (or REL), is tested in this
algorithm.  The algorithm requires as input a full model including all known and
proposed RELs, a set of experiments to determine the congruence of model and
experiment, and a confidence estimation for the existence of each REL.</p>
<p>The algorithm requires a set of parameters to estimate.  In this case the
existence of a particular REL is cast as a boolean parameter and prior confidence
for the existence of that REL is taken from the confidence estimation provided.
The existence of all RELs with a confidence less than 1 are included as
parameters in the ABC-SMC and will be either included in or excluded from each
proposed model created by the algorithm.</p>
<p>The algorithm will propose a large number of alternative models, calculating
for them the congruence with the experimental data provided.  Models will be
accepted if their distance measure form the experimental data falls below a
specified value (epsilon).  Once N models have been found that are accepted,
epsilon is reduced and new models are proposed by selecting a random accepted
model from the previous step and perturbing it.  At each step both epsilon and
the perturbation strength are reduced until a set of N models is settled upon,
having a low epsilon.</p>
<p>The output is therefore a set of N models, each with a high congruence with the
observed experimental data.  The confidence for the existence of each REL in
reality can then be calculated as the proportion of these models containing
that REL.</p>
<p>For further information on the algorithm and formulation of inputs, see the
accompanying paper.</p>
</div>
<div class="section" id="license">
<h2>LICENSE<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>This program is free software, distributed under the terms of the GNU GPL:
you can redistribute it and/or modify it under the terms of the GNU General
Public License as published by the Free Software Foundation, either version 3
of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>
</div>
<div class="section" id="installation">
<h2>INSTALLATION<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>This module does not need to be installed; if the directory containing this
file is in the PYTHONPATH, it can be imported using:</p>
<p><cite>import abcsmc</cite></p>
</div>
<div class="section" id="prerequisites">
<h2>PREREQUISITES<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>This module has been tested with Python 2.7</p>
<p>Required non-standard Python packages (tested versions specified in brackets):</p>
<ul class="simple">
<li>COBRApy (0.4.0b4)</li>
<li>NumPy (1.10.4)</li>
<li>LibSBML (5.12.1) for SBML import and export</li>
<li>Pyparsing (2.0.3) for GPR &lt;&#8211;&gt; list of enzymes translation</li>
</ul>
<p>This package also requires the installation of a compatible linear optimisation
program.  Testing has shown Gurobi to be up to 30 times faster than the free
GLPK program, and is available for free with an academic license when used
solely for the purposes of research.</p>
</div>
<div class="section" id="example-usage">
<h2>EXAMPLE USAGE<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<p>Most C{AbcProblem} arguments are optional (or conditionally optional), the
following are required:</p>
<ul class="simple">
<li>An SBML file containing the model including predicted RELs</li>
<li>An experiment file <a class="footnote-reference" href="#id2" id="id1">[1]</a> containing results of gene essentiality analyses</li>
<li>if the &#8216;include_all&#8217; variable is set to False (default) then a list
of candidate RELs for inclusion/exclusion must be supplied (e.g.
&#8216;example/candidate_rels.tsv&#8217;)</li>
</ul>
<p>Default values for variables are set for the purposes of testing, rather than
full analysis.  This example uses non-default values for several optional
variables.</p>
<p>Create problem object:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">abc_problem</span> <span class="o">=</span> <span class="n">AbcProblem</span><span class="p">(</span>
    <span class="n">model_file</span><span class="o">=</span><span class="s1">&#39;example/model.xml&#39;</span><span class="p">,</span>
    <span class="n">experiments_file</span><span class="o">=</span><span class="s1">&#39;example/experiments.xml&#39;</span><span class="p">,</span>
    <span class="n">prior_file</span><span class="o">=</span><span class="s1">&#39;example/candidate_rels.tsv&#39;</span><span class="p">,</span>
    <span class="n">particles_per_population</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">num_populations_max</span><span class="o">=</span><span class="mi">6</span>
<span class="p">)</span>
</pre></div>
</div>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>The experiment file has a specific format, as set out in the file
&#8216;example/experiments.tsv&#8217;</td></tr>
</tbody>
</table>
<p>&#64;author: wbryant</p>
<dl class="class">
<dt id="abcsmc.AbcProblem">
<em class="property">class </em><code class="descclassname">abcsmc.</code><code class="descname">AbcProblem</code><span class="sig-paren">(</span><em>model</em>, <em>biomass_id</em>, <em>experiments</em>, <em>prior_file=None</em>, <em>particles_per_population=10</em>, <em>num_populations_max=5</em>, <em>default_prior_value=0.99</em>, <em>enzyme_limit=10</em>, <em>epsilon_0=0.5</em>, <em>epsilon_T=0.285</em>, <em>p_0=0.2</em>, <em>alpha=0.01</em>, <em>original_model_rxn_ids=None</em>, <em>solver=None</em>, <em>prior_multiplier=None</em>, <em>test_type=None</em>, <em>test_model_pre_abc=True</em>, <em>include_fn_reactions=True</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem" title="Permalink to this definition">¶</a></dt>
<dd><p>An ABC-SMC problem with functions for solving it.</p>
<p>This class contains all of the information and functions for solving the
problem of which RELs should be retained in a proposed model.  When solving
the problem an instance of this class is created, then the simulation is
run with the contained functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<em>str</em>) &#8211; The filename of the complete model encoded in SBML, including
all proposed RELs</li>
<li><strong>biomass_id</strong> (<em>str</em>) &#8211; The ID for the biomass reaction to be used for gene
essentiality testing</li>
<li><strong>experiments</strong> (<em>str</em>) &#8211; The filename of the list of experiment results that will
be tested in the model</li>
<li><strong>prior_file</strong> (<em>str</em>) &#8211; (Optional) A file containing confidence values for all reactions to be
considered for addition/removal in ABC-SMC.  If not specified, all
reactions will be included</li>
<li><strong>particles_per_population</strong> (<em>int</em>) &#8211; (Optional, def: 10) The number of models that must be accepted in each
step of the ABC problem, each passing the distance criterion</li>
<li><strong>num_populations_max</strong> (<em>int</em>) &#8211; (Optional, def: 5) The maximum number of steps to take in the problem
before returning the posterior distribution for each parameter</li>
<li><strong>default_prior_value</strong> (<em>float</em>) &#8211; (Optional, def: 0.99) The value of the prior for RELs for which a prior
value has not been given (the default confidence assigned to RELs that
are included in the ABC problem)</li>
<li><strong>enzyme_limit</strong> (<em>int</em>) &#8211; (Optional, def: 10) If a reaction under consideration has multiple
enzymes, the maximum number of such enzymes for which the reaction will
be split into individual RELs.  Assigned for the purposes of
performance</li>
<li><strong>epsilon_0</strong> (<em>float</em>) &#8211; (Optional, def: 0.5) Distance functions must be normalised to maximum 1
and minimum 0; this value represents the maximum distance that
will be accepted in the initial step</li>
<li><strong>epsilon_T</strong> (<em>float</em>) &#8211; (Optional, def: 0.285) Distance cutoff for the final step in the
algorithm, if it gets to <code class="docutils literal"><span class="pre">num_populations_max</span></code>.  Intermediate
distance cutoffs, for each step between the first and the last, are
calculated between <code class="docutils literal"><span class="pre">epsilon_0</span></code> and this value</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="abcsmc.AbcProblem.create_population_t">
<code class="descname">create_population_t</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.create_population_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.create_prior_estimate">
<code class="descname">create_prior_estimate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.create_prior_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Use theta_accepted_set to estimate new prior for determining transition probabilities.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.export_particle_rels">
<code class="descname">export_particle_rels</code><span class="sig-paren">(</span><em>timepoint</em>, <em>particle_index</em>, <em>rel_output_file</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.export_particle_rels" title="Permalink to this definition">¶</a></dt>
<dd><p>Export RELs from any particle from any of the timepoints.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.get_epsilon">
<code class="descname">get_epsilon</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.get_epsilon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.get_epsilon_linear">
<code class="descname">get_epsilon_linear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.get_epsilon_linear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.get_p_transition">
<code class="descname">get_p_transition</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.get_p_transition" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.initialise_particle">
<code class="descname">initialise_particle</code><span class="sig-paren">(</span><em>particle_id</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.initialise_particle" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new particle from the current ABC timepoint.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.record_previous_results">
<code class="descname">record_previous_results</code><span class="sig-paren">(</span><em>theta_accepted_set</em>, <em>ln_w_accepted_set</em>, <em>distance_set</em>, <em>proposed_theta_idx_set</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.record_previous_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the results from the previous run to the full lists of results.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.step_forwards">
<code class="descname">step_forwards</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.step_forwards" title="Permalink to this definition">¶</a></dt>
<dd><p>Increment time and calculate new problem parameters.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.test_theta">
<code class="descname">test_theta</code><span class="sig-paren">(</span><em>thetaTest</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.test_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a manually defined theta and test against the experiments in
the ABC problem, returning a ResultSet instance with the results in it.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.AbcProblem.update_weights">
<code class="descname">update_weights</code><span class="sig-paren">(</span><em>ln_weights=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.AbcProblem.update_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalise outputed weights and update w_set_prev.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abcsmc.Experiment">
<em class="property">class </em><code class="descclassname">abcsmc.</code><code class="descname">Experiment</code><span class="sig-paren">(</span><em>expt_id</em>, <em>medium</em>, <em>result</em>, <em>genotype=None</em>, <em>objective=None</em>, <em>old_expt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>The details of a real experiment formatted for testing a constraint-based model.</p>
<dl class="method">
<dt id="abcsmc.Experiment.test">
<code class="descname">test</code><span class="sig-paren">(</span><em>ec_model</em>, <em>precalc_frozensets=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Experiment.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate whether ec_model is consistent with this experiment.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abcsmc.ExtendedCobraModel">
<em class="property">class </em><code class="descclassname">abcsmc.</code><code class="descname">ExtendedCobraModel</code><span class="sig-paren">(</span><em>description=None</em>, <em>deepcopy_model=False</em>, <em>matrix_type='scipy.lil_matrix'</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional functionality for helping to use COBRA model.</p>
<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.enzyme_to_gpr">
<code class="descname">enzyme_to_gpr</code><span class="sig-paren">(</span><em>enzyme_string</em>, <em>warn_if_absent=False</em>, <em>reject_if_absent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.enzyme_to_gpr" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert enzyme string to GPR string.
Enzyme string should be a comma separated list of valid
gene loci.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.enzymes_as_gprs">
<code class="descname">enzymes_as_gprs</code><span class="sig-paren">(</span><em>reaction</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.enzymes_as_gprs" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand the GPR for the given reaction and list all enzymes as separate GPRs.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.get_relevant_gene_ids">
<code class="descname">get_relevant_gene_ids</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.get_relevant_gene_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of gene IDs for all genes implicated in non-zero flux reactions.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.opt">
<code class="descname">opt</code><span class="sig-paren">(</span><em>new_objective=None</em>, <em>time_limit=1</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.opt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.set_genotype">
<code class="descname">set_genotype</code><span class="sig-paren">(</span><em>genotype</em>, <em>return_ko_rxns=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.set_genotype" title="Permalink to this definition">¶</a></dt>
<dd><p>Run delete_model_genes on model.  Return False if no change is made to the model</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.set_medium">
<code class="descname">set_medium</code><span class="sig-paren">(</span><em>medium_dict=None</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.set_medium" title="Permalink to this definition">¶</a></dt>
<dd><p>Set exchanges of all exchange reactions to zero, or what is in medium_dict.
medium_dict: key = reaction ID, value = new lower bound.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.set_solver">
<code class="descname">set_solver</code><span class="sig-paren">(</span><em>solver_string='cglpk'</em>, <em>require_solver=True</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.set_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.show_medium">
<code class="descname">show_medium</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.show_medium" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all exchange lower bounds &lt; 0 and print to screen.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.split_rxn_by_enzymes">
<code class="descname">split_rxn_by_enzymes</code><span class="sig-paren">(</span><em>reaction_id</em>, <em>enzyme_limit=10</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.split_rxn_by_enzymes" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a reaction from the model and add new reactions for each potential enzyme.</p>
<p>Do not split the reaction if the number of predicted enzymes is &gt; enzyme_limit.</p>
<p>Original reaction is retained as a &#8216;hypothetical&#8217; (unidentified) enzyme.</p>
<p>Return list of IDs created for these enzrxns.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.ExtendedCobraModel.unset_genotype">
<code class="descname">unset_genotype</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ExtendedCobraModel.unset_genotype" title="Permalink to this definition">¶</a></dt>
<dd><p>Run undelete_model_genes on model.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abcsmc.Particle">
<em class="property">class </em><code class="descclassname">abcsmc.</code><code class="descname">Particle</code><span class="sig-paren">(</span><em>theta_set_prev</em>, <em>w_set_prev</em>, <em>model</em>, <em>experiments</em>, <em>epsilon_curr</em>, <em>prior_set</em>, <em>p_transition_curr</em>, <em>t</em>, <em>N</em>, <em>particle_id</em>, <em>num_expts_pos</em>, <em>num_expts_neg</em>, <em>ln_pi_max</em>, <em>precalc_media</em>, <em>precalc_media_frozensets</em>, <em>prior_estimate</em>, <em>essential_theta_sets</em>, <em>test_type</em>, <em>num_essential_expts</em>, <em>prior_set_original</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle" title="Permalink to this definition">¶</a></dt>
<dd><p>A self-contained ABC particle that will return an accepted parameter set and its weight.</p>
<dl class="method">
<dt id="abcsmc.Particle.K_t">
<code class="descname">K_t</code><span class="sig-paren">(</span><em>theta_previous=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.K_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Perturbation function!</p>
<p>Return a perturbed theta, theta_perturbed, from theta_sampled according to a simple distribution.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.K_t_modified">
<code class="descname">K_t_modified</code><span class="sig-paren">(</span><em>theta_previous=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.K_t_modified" title="Permalink to this definition">¶</a></dt>
<dd><p>Perturbation function based on current estimated priors for reaction presence parameters.</p>
<p>Return a perturbed theta, theta_perturbed, from theta_sampled according to a modified distribution.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.apply_proposed_theta">
<code class="descname">apply_proposed_theta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.apply_proposed_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Set constraints on model according to proposed theta.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.calculate_ln_w">
<code class="descname">calculate_ln_w</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.calculate_ln_w" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate ln(weight) for this particle.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.calculate_ln_weight_denominator">
<code class="descname">calculate_ln_weight_denominator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.calculate_ln_weight_denominator" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the logarithm of the weighted sum of the K_ts for the
calculation of weight.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.calculate_ln_weight_denominator_modified">
<code class="descname">calculate_ln_weight_denominator_modified</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.calculate_ln_weight_denominator_modified" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the logarithm of the weighted sum of the K_ts for the
calculation of weight.</p>
<p>For the modified K_t, the shortcut leveraging the fact that all transition
probabilities are the same does not work so all must be calculated sequentially.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.conduct_experiments">
<code class="descname">conduct_experiments</code><span class="sig-paren">(</span><em>debug=False</em>, <em>epsilon=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.conduct_experiments" title="Permalink to this definition">¶</a></dt>
<dd><p>Conduct experiments for model in current state and return 1 - (balanced accuracy).</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.conduct_experiments_essential_and_orphan_mets">
<code class="descname">conduct_experiments_essential_and_orphan_mets</code><span class="sig-paren">(</span><em>orphans_weight=0.1</em>, <em>debug=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.conduct_experiments_essential_and_orphan_mets" title="Permalink to this definition">¶</a></dt>
<dd><p>Conduct experiments for model in current state and return 1 - (balanced accuracy).</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.find_accepted_theta">
<code class="descname">find_accepted_theta</code><span class="sig-paren">(</span><em>debug=False</em>, <em>use_ln=True</em>, <em>use_simple_K=False</em>, <em>max_tests=100000</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.find_accepted_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Find accepted theta and return it with weight.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.ln_pi">
<code class="descname">ln_pi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.ln_pi" title="Permalink to this definition">¶</a></dt>
<dd><p>find logarithm of the prior for calculating logarithm of weight.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.n_diff_min_and_residuals">
<code class="descname">n_diff_min_and_residuals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.n_diff_min_and_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>From the previous accepted theta set, calculate the minimum number
of changes from any of them to the accepted theta.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.param_p_sourced">
<code class="descname">param_p_sourced</code><span class="sig-paren">(</span><em>idx</em>, <em>param</em>, <em>param_previous</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.param_p_sourced" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the probability of a parameter having come from a previous parameter given a pertubation.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.perturb_param_using_prior">
<code class="descname">perturb_param_using_prior</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.perturb_param_using_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Return p_transition based on current prior estimate for REL idx.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.pi">
<code class="descname">pi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.pi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return probability of getting a particular theta by sampling at random from the prior.
If theta is not specified, sample randomly from the prior.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.propose_theta">
<code class="descname">propose_theta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.propose_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample theta from previous iteration and perturb according to K_t.</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.reset_prior">
<code class="descname">reset_prior</code><span class="sig-paren">(</span><em>prior_multiplier=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.reset_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Set prior to original values, and apply prior_multiplier if specified</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.Particle.vprint">
<code class="descname">vprint</code><span class="sig-paren">(</span><em>string</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.Particle.vprint" title="Permalink to this definition">¶</a></dt>
<dd><p>Print if verbose is true - override class verbosity with specified verbosity</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abcsmc.ResultSet">
<em class="property">class </em><code class="descclassname">abcsmc.</code><code class="descname">ResultSet</code><span class="sig-paren">(</span><em>tp=0</em>, <em>tn=0</em>, <em>fp=0</em>, <em>fn=0</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ResultSet" title="Permalink to this definition">¶</a></dt>
<dd><p>A container for a set of results that can return stats</p>
<dl class="method">
<dt id="abcsmc.ResultSet.accuracy">
<code class="descname">accuracy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ResultSet.accuracy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.ResultSet.balanced_accuracy">
<code class="descname">balanced_accuracy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ResultSet.balanced_accuracy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.ResultSet.calc_balanced_tfpn_addition">
<code class="descname">calc_balanced_tfpn_addition</code><span class="sig-paren">(</span><em>num_tests_remaining</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ResultSet.calc_balanced_tfpn_addition" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.ResultSet.f_measure">
<code class="descname">f_measure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ResultSet.f_measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.ResultSet.max_balanced_accuracy">
<code class="descname">max_balanced_accuracy</code><span class="sig-paren">(</span><em>num_tests_remaining</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ResultSet.max_balanced_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a number of tests to be added to the results, what is the
maximum balanced accuracy that could be achieved?</p>
</dd></dl>

<dl class="method">
<dt id="abcsmc.ResultSet.precision">
<code class="descname">precision</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ResultSet.precision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.ResultSet.recall">
<code class="descname">recall</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ResultSet.recall" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.ResultSet.stats">
<code class="descname">stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.ResultSet.stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="abcsmc.conduct_experiments">
<code class="descclassname">abcsmc.</code><code class="descname">conduct_experiments</code><span class="sig-paren">(</span><em>model</em>, <em>experiments</em>, <em>debug=False</em>, <em>epsilon=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.conduct_experiments" title="Permalink to this definition">¶</a></dt>
<dd><p>Conduct experiments for model in current state and return 1 - (balanced accuracy).</p>
</dd></dl>

<dl class="function">
<dt id="abcsmc.create_extended_model">
<code class="descclassname">abcsmc.</code><code class="descname">create_extended_model</code><span class="sig-paren">(</span><em>model_file</em>, <em>objective_id='Biomass_BT_v2'</em>, <em>require_solver=True</em>, <em>solver='cglpk'</em>, <em>tidy_ids=True</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.create_extended_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Take an ArrayBasedModel and convert to an Extended_Cobra_Model.</p>
</dd></dl>

<dl class="function">
<dt id="abcsmc.import_expt_data">
<code class="descclassname">abcsmc.</code><code class="descname">import_expt_data</code><span class="sig-paren">(</span><em>model</em>, <em>objective_id='Biomass_BT_v2'</em>, <em>media=None</em>, <em>data_file=None</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.import_expt_data" title="Permalink to this definition">¶</a></dt>
<dd><p>From a table of genotype/growth information, create the experiments
for a particular organism.</p>
<p>If there are any lines at the top of the file starting with the word
&#8220;MEDIUM&#8221; in the first column the next column will be the medium name and
the following cells will contain medium components for specifying media
used in the experiments.</p>
</dd></dl>

<dl class="function">
<dt id="abcsmc.import_media">
<code class="descclassname">abcsmc.</code><code class="descname">import_media</code><span class="sig-paren">(</span><em>media_shelf_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.import_media" title="Permalink to this definition">¶</a></dt>
<dd><p>Import media values from a media shelf file for input into experiments.</p>
</dd></dl>

<dl class="function">
<dt id="abcsmc.import_prior_dict">
<code class="descclassname">abcsmc.</code><code class="descname">import_prior_dict</code><span class="sig-paren">(</span><em>prior_files</em>, <em>rem_default=0.9</em>, <em>add_default=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.import_prior_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create prior dictionary from prior files, giving default prior values
where not specified.</p>
</dd></dl>

<dl class="class">
<dt id="abcsmc.loop_counter">
<em class="property">class </em><code class="descclassname">abcsmc.</code><code class="descname">loop_counter</code><span class="sig-paren">(</span><em>length</em>, <em>message='Entering loop'</em>, <em>timed=False</em>, <em>add_delay=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.loop_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Use to track progress of a loop of known length.</p>
<dl class="method">
<dt id="abcsmc.loop_counter.step">
<code class="descname">step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.loop_counter.step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abcsmc.loop_counter.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.loop_counter.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="abcsmc.random">
<code class="descclassname">abcsmc.</code><code class="descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; x in the interval [0, 1).<a class="headerlink" href="#abcsmc.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="abcsmc.timeout">
<code class="descclassname">abcsmc.</code><code class="descname">timeout</code><span class="sig-paren">(</span><em>func</em>, <em>args=()</em>, <em>kwargs={}</em>, <em>timeout_duration=60</em>, <em>default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abcsmc.timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Run func, but exit after timeout_duration if func hasn&#8217;t completed.</p>
</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Welcome to ABC-SMC for GEM Improvement&#8217;s documentation!</a><ul>
<li><a class="reference internal" href="#abstract">ABSTRACT</a></li>
<li><a class="reference internal" href="#summary">SUMMARY</a></li>
<li><a class="reference internal" href="#license">LICENSE</a></li>
<li><a class="reference internal" href="#installation">INSTALLATION</a></li>
<li><a class="reference internal" href="#prerequisites">PREREQUISITES</a></li>
<li><a class="reference internal" href="#example-usage">EXAMPLE USAGE</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Dr William A Bryant.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>